<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>    
  </head>
  <body>    
    <div id="register_list"></div>
  </body>
</html>
<script>
// google.script.run.withSuccessHandler(injectHTML)
$(function() {
  google.script.run.withSuccessHandler(showRegisterTable).getRegister();
});

function showRegisterTable(lists) {
  console.log("Create Lists");  
  register_list = $('#register_list');
  register_list.html("Loading");
  
  var code = "<table class='table'>";
  code += "<tr>";
  code += "<th>รหัสนักศึกษา</th>";
  code += "<th>ชื่อ - สกุล</th>";
  code += "<th>คณะ/สังกัด</th>";
  code += "</tr>";
  $.each(lists, function(ind, val) {
    if(ind > 0) {
      code += "<tr>";
      code += "<td>" + val.student_code + "</td>";
      code += "<td>" + val.student_name + "</td>";
      code += "<td>" + val.faculty_name + "</td>";
      //console.log(val.student_code);
      code += "</tr>";
    }
  });
  code += "</table>";
  register_list.html(code);
}
</script>